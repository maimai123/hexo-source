---
title: React Hooks
date: 2020-02-27
tags: React
---
<font size=1>**è½¬è½½è‡³[ä¼æ¨±å¤§é­”](https://juejin.im/post/5e53d9116fb9a07c9070da44)**</font>

# useState
**ä¸ºä»€ä¹ˆè¦ä½¿ç”¨useStateï¼Ÿ**
useState çš„å‡ºç°æ˜¯ ï¼š åœ¨å‡½æ•°ç»„ä»¶é‡Œé¢ä½¿ç”¨ classçš„setStateï¼Œåˆºæ¿€!!!
è§£å†³äº†çš„é—®é¢˜æ˜¯ï¼šå½“æˆ‘ä»¬ä¸€ä¸ªå‡½æ•°ç»„ä»¶æƒ³è¦æœ‰è‡ªå·±ç»´æŠ¤çš„stateçš„æ—¶å€™ï¼Œä¸å¾—å·²åªèƒ½è½¬æ¢æˆclassã€‚è¿™æ ·å¾ˆéº»çƒ¦ï¼

**å¦‚ä½•ä½¿ç”¨useStateï¼Ÿ**

```javascript
const [visible, setVisible] = useState(false)
```
**useStateè¸©å‘çŸ¥è¯†ç‚¹**

ğŸ‘é‡ç‚¹ï¼š **useStateçš„åˆå§‹å€¼ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡æœ‰æ•ˆ**

æˆ‘å½“æ—¶åæ­£æ²¡æœ‰å½“å›äº‹ï¼Œç›´åˆ°é‡åˆ°äº†å‘...

ä¸¾ä¸ªğŸŒ°ï¼š

```javascript
const Child = memo(({data}) =>{
    const [name, setName] = useState(data)
    return (
        <div>
            <div>child</div>
            <div>{name} --- {data}</div>
        </div>
    );
})

const Hook =()=>{
    const [count, setCount] = useState(0)
    const [name, setName] = useState('rose')

    return(
        <div>
            <div>
                {count}
            </div>
            <button onClick={()=>setCount(count+1)}>update count </button>
            <button onClick={()=>setName('jack')}>update name </button>
            <Child data={name}/>
        </div>
    )
}
```
> ç»“è®ºï¼š å®è·µæ£€éªŒçŸ¥è¯†ç‚¹ï¼ğŸ˜­

# useEffect
**ä¸ºä»€ä¹ˆè¦ä½¿ç”¨useEffectï¼Ÿ**
useEffect çš„å‡ºç°æ˜¯ ï¼š åœ¨å‡½æ•°ç»„ä»¶é‡Œé¢ä½¿ç”¨ classçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè¿˜æ˜¯æ‰€ä»¥å‡½æ•°çš„åˆä½“ï¼åˆºæ¿€ï¼ï¼ï¼

**å¦‚ä½•ä½¿ç”¨useEffect?**

```javascript
useEffect(()=>{
    // ä½ çš„ä»£ç ...
})
```

**useEffectçŸ¥è¯†ç‚¹åˆé›†**

1.åªåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„componentDidMountï¼Œå¯ä»¥ç”¨æ¥è¯·æ±‚å¼‚æ­¥æ•°æ®...ã€

useEffectæœ€åï¼ŒåŠ äº† **[]** å°±è¡¨ç¤ºåªç¬¬ä¸€æ¬¡æ‰§è¡Œ

```javascript
useEffect(()=>{
    const users = è·å–ä½ å–œæ¬¢çš„äººçš„ä¿¡æ¯()
},[])
```
2.ç”¨æ¥æ›¿ä»£willUpdateç­‰æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œçš„ç”Ÿå‘½å‡½æ•°

useEffectæœ€åï¼Œä¸åŠ  **[]** å°±è¡¨ç¤ºæ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ
```javascript
useEffect(()=>{
    const users = æ¯æ¬¡æ¸²æŸ“éƒ½è·å–ä½ å–œæ¬¢çš„äººçš„ä¿¡æ¯()
})
```
3.æ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œæ„Ÿè§‰æœ‰ç‚¹è´¹ï¼Œæ‰€ä»¥ï¼š

useEffectæœ€ååŠ  **[]** ï¼Œå¹¶ä¸” **[]** é‡Œé¢åŠ çš„å­—æ®µå°±è¡¨ç¤ºï¼Œè¿™ä¸ªå­—æ®µæ›´æ”¹äº†ï¼Œæˆ‘è¿™ä¸ªeffectæ‰æ‰§è¡Œ
```javascript
useEffect(() => {
    const users = ï¼ˆnameæ”¹å˜äº†æˆ‘æ‰è·å–ä½ å–œæ¬¢çš„äººçš„ä¿¡æ¯()ï¼‰
},[name])
```
4.å¦‚æœæˆ‘ä»¬ä¹‹å‰è®¢é˜…äº†ä»€ä¹ˆï¼Œæœ€ååœ¨willUnmountè¿™ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œé¢è¦å–æ¶ˆè®¢é˜…ï¼Œè¿™å¯å’‹ç”¨useEffectå®ç°å•Šï¼š

åœ¨effectçš„returné‡Œé¢å¯ä»¥åšå–æ¶ˆè®¢é˜…çš„äº‹
```javascript
    useEffect(() => {
        const subscription = è·å–ä½ å–œæ¬¢çš„äººçš„ä¿¡æ¯()
        return () => {
            æˆ‘ä¸è¦åœ¨å–œæ¬¢ä½ äº†()
        }
    },[])
```
**ä¸ºä»€ä¹ˆè¦å–æ¶ˆè®¢é˜…ï¼Ÿ**
å¤§å®¶éƒ½çŸ¥é“ï¼Œrenderäº†ä¹‹åä¼šæ‰§è¡Œé‡æ–°useEffectï¼Œå¦‚æœuseEffecté‡Œé¢æœ‰ä¸€ä¸ªæ¯setInterval...é‚£ä¹ˆæ¯æ¬¡renderäº†ï¼Œå†æ¬¡æ‰§è¡ŒuseEffectå°±ä¼šå†åˆ›å»ºä¸€ä¸ªsetIntervalï¼Œç„¶åå°±æ··ä¹±äº†...å¯ä»¥æŠŠä¸‹é¢æ¡ˆä¾‹returnçš„å†…å®¹åˆ æ‰æ„Ÿå—ä¸‹
```javascript
    useEffect(() => {
        console.log('use effect...',count)
        const timer = setInterval(() => setCount(count + 1), 1000)
        return ()=> clearInterval(timer)
    })
```

5.useEffect é‡Œé¢ä½¿ç”¨åˆ°çš„stateçš„å€¼, å›ºå®šåœ¨äº†useEffectå†…éƒ¨ï¼Œ ä¸ä¼šè¢«æ”¹å˜ï¼Œé™¤éuseEffectåˆ·æ–°ï¼Œé‡æ–°å›ºå®šstateçš„å€¼
```javascript
 const [count, setCount] = useState(0)
    useEffect(() => {
        console.log('use effect...',count)
        const timer = setInterval(() => {
            console.log('timer...count:', count)
            setCount(count + 1)
        }, 1000)
        return ()=> clearInterval(timer)
    },[])
```

6.useEffectä¸èƒ½è¢«åˆ¤æ–­åŒ…è£¹

```javascript
 const [count, setCount] = useState(0)
    if(2 < 5){
    useEffect(() => {
            console.log('use effect...',count)
            const timer = setInterval(() => setCount(count +1), 1000)
            return ()=> clearInterval(timer)
        })
    }
```

7.useEffectä¸èƒ½è¢«æ‰“æ–­
```javascript
const [count, setCount] = useState(0)
useEffect(...)

return // å‡½æ•°æå‰ç»“æŸäº†

useEffect(...)
}
```
è¿˜æœ‰**useMemo** **useRef**ç­‰ç­‰... æ¬çš„å¤ªè¾›è‹¦äº†ï¼Œå¤§å®¶ç›´æ¥ç‚¹å‡»[æ–‡ç« åœ°å€](https://juejin.im/post/5e53d9116fb9a07c9070da44)å»çœ‹å§ ğŸ˜­

More info: [éº¦éº¦](maimai123.github.io)
